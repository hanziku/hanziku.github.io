(()=>{var R=Math.pow;var Ht=(e,t)=>{let n=parseInt(e(0)),r=1,o=n;for(;r<o;){let i=r+o>>1;if(e(i)===t){for(;i>-1&&e(i-1)===t;)i--;return i<n?i:n-1}e(i)<t?r=i+1:o=i}return r<n?r:n};var qt=(e,t)=>{let n=[],r=0;for(let o=0;o<e.length;o++){let i=e[o];for(;r<t.length&&!(t[r]>=i);)r++;if(i==t[r]&&n[n.length-1]!==i&&n.push(i),r==t.length)break}return n};var Ct="\x7F";var Vt=e=>{let t=[],n,r=Math.floor(e.length);for(let o=0;o<r;o++)n=e.charCodeAt(o*3)-14,t.push(n);return t},Tt=(e,t=!1)=>{let n=[],r=!1;if(!e)return[];let o,i=0,s=0,a=0;for(;i<e.length;){if(o=e.charCodeAt(i)-14,!(o<45))if(o<89){let c=e.charCodeAt(++i)-14;o-=45,o=o*113+c+45}else if(o<105){let c=e.charCodeAt(++i)-14,h=e.charCodeAt(++i)-14;o-=89,o=o*113*113+c*113+h+5017}else if(o<112){let c=e.charCodeAt(++i)-14,h=e.charCodeAt(++i)-14,d=e.charCodeAt(++i)-14;o-=105,o=o*113*113*113+c*113*113+h*113+d+209321}else if(o<127){let c=e.charCodeAt(++i)-14,h=e.charCodeAt(++i)-14,d=e.charCodeAt(++i)-14,l=e.charCodeAt(++i)-14;o-=112,o=o*113*113*113*113+c*113*113*113+h*113*113+d*113+l+209321}else throw new Error("exit max integer 0x7f,"+o);r?(n[s]=o+(t?a:0),a=n[s],s++):(n=new Array(o),r=!0),i++}return n};var or=String.fromCharCode(14);var bt=e=>{if(!e)return[];let t=0,n=[];for(;t<e.length;){let r=e.codePointAt(t)||0;n.push(r),t++,r>65535&&t++}return n},et=e=>bt(e).map(t=>String.fromCodePoint(t)),rt=e=>bt(e).length;var nt=class{constructor(t,n){this.buf="";this.sep="";this.linepos=[];this.buf=t,this.sep=n||"",this.buildLinepos()}buildLinepos(){let t=-1,n=0;for(;n<this.buf.length;){let r=this.buf.indexOf(`
`,t);if(r==-1){this.linepos.push(this.buf.length);break}else this.linepos.push(r+1),t=r+1}}len(){return this.linepos.length}get(t){return t<1?this.linepos.length.toString():t==1?this.buf.slice(0,this.linepos[0]-1):t<=this.linepos.length?this.buf.slice(this.linepos[t-2],this.linepos[t-1]-1):""}find(t){let n=this.get.bind(this);t+=this.sep;let r=Ht(n,t);return n(r).startsWith(t)?r:0}getValue(t){let n=this.find(t);return n?this.get(n).slice(t.length+this.sep.length):""}};var Qt={BMP:[19968,40869],ExtA:[13312,19967],ExtB:[131072,173823],ExtC:[173824,177983],ExtD:[177984,178207],ExtE:[178208,183983],ExtF:[183984,191456],ExtG:[196608,201546]};var Jt=e=>{let t=e;if(typeof e=="string"){let n=parseInt(e,16);isNaN(n)?t=e.codePointAt(0):t=n}for(let n in Qt){let[r,o]=Qt[n];if(t>=r&&t<=o)return n}};var Yt=10,Zt=4e3,gt=e=>{if(!e)return"";let t=e.split(Ct),n=[];for(let r=0;r<t.length;r++){let o=t[r],i=[],s=Vt(o[0]);if(s[0]>Yt){let a=s[0]-Yt,c=ge(o.slice(1,a+1)),[h,d,l,m,p,f,k,x]=Tt(o.slice(a+1)).map(te);i.push("99"),i.push(p||"0",f||"0",h||"0",d||"0",l||"0",m||"0",c),i.push("0",k||"0",x||"0")}else{let a=s[0],c=Array.from(Tt(o.slice(1)).map(te));i.push(a,...c)}n.push(i.join(":"))}return n.join("$")};var te=e=>e>Zt?-e+Zt:(e-=Yt,e);var ge=e=>{let t=e.codePointAt(0)||0,n="";if(t>255){let r=et(e);n="u"+t.toString(16),r.length>1&&(n+=(r[1]!=="@"?"-":"")+e.slice(r[0].length))}else return e;return n};var xt,Mt,yt,xe=e=>{let t="";return typeof e=="number"?ct(e):typeof e=="string"?((e.codePointAt(0)||0)>8192&&(e="u"+(e.codePointAt(0)||0).toString(16)),e.replace(/@\d+$/,"")):""},ct=e=>"u"+(typeof e=="number"?e:e?.codePointAt(0)||" ").toString(16),U=e=>{if(typeof e=="number"&&(e=String.fromCodePoint(e)),!e||typeof e=="string"&&(e.codePointAt(0)||0)>255&&rt(e)>1)return"";let t=xe(e),n=t.match(/^u([\da-f]{4,5})$/);if(n){let r=parseInt(n[1],16);if(r>=131072){let o=Mt.get(r-131072+1);return gt(o)}else if(r>=13312&&r<40959){let o=xt.get(r-13312+1);return gt(o)}}return gt(yt.getValue(t))},jt=0,ot=(e,t,n=!1)=>{let r=e.split("$");if(jt++,jt>10){console.log("too deep fetching",e);return}for(let o=0;o<r.length;o++)if(r[o].slice(0,3)=="99:"){let i=r[o].slice(r[o].lastIndexOf(":")+1);parseInt(i).toString()==i&&(i=r[o].split(":")[7].replace(/@\d+$/,""));let s=U(i);s?(n?(t[i]||(t[i]=0),t[i]++):t[i]||(t[i]=U(i)),ot(s,t,n)):console.log("glyph not found",i)}jt--};function _t(e,t=""){let n=e.split("$"),r=[],o="";for(let i=0;i<n.length;i++)if(n[i].slice(0,3)==="99:"){let[s,a,c,h,d,l,m,p]=n[i].split(":"),f=[parseInt(h),parseInt(d),parseInt(l),parseInt(m)];r.push(f),o=p}return!t&&r.length==1&&(r=_t(U(o))),r}var ee=e=>{if(e[0]!=="u")return" ";let t=parseInt(e.slice(1),16);return(t<32||isNaN(t))&&(t=32),String.fromCodePoint(t)};var Me=e=>e.split("$").filter(t=>t!=="0:0:0:0").map(t=>t.split(":")),St=(e,t)=>{let n=Me(e),r=[];if(n.length==1&&n[0][0]==="99"){let o=n[0][7];return St(U(o),o)}for(let o=0;o<n.length;o++)n[o][0]==="99"&&r.push(n[o][7]);return t?r:r.map(ee).join("")},re=(e,t=!1)=>{let n=U(e);return ye(n,t).filter(r=>r!==e)},ye=(e,t=!1)=>{let n={};ot(e,n);let r=Object.keys(n);return t?r:r.map(ee)},ut=(e,t)=>{if(e=="gwcomp")yt=new nt(t,"=");else if(e=="cjkbmp")xt=new nt(t);else if(e=="cjkext")Mt=new nt(t);else throw"wrong font key"},ne=()=>yt&&xt&&Mt,oe=(e,t,n)=>(ut("gwcomp",e),ut("cjkbmp",t),ut("cjkext",n),{gwcomp:yt,cjkbmp:xt,cjkext:Mt});var ie={},$=(e,t)=>{ie[e]=t},se=e=>ie[e];$("\u5B8B\u4F53",{kMinWidthY:2,kMinWidthU:2,kMinWidthT:4.5,kWidth:5});$("\u7EC6\u5B8B\u4F53",{kMinWidthY:2,kMinWidthU:1,kMinWidthT:3,kWidth:5});$("\u4E2D\u5B8B\u4F53",{kMinWidthY:2,kMinWidthU:2,kMinWidthT:6,kWidth:5});$("\u7C97\u5B8B\u4F53",{kMinWidthY:2.5,kMinWidthU:2,kMinWidthT:7,kWidth:5});$("\u7279\u5B8B\u4F53",{kMinWidthY:3,kMinWidthU:2,kMinWidthT:8,kWidth:5});$("\u9ED1\u4F53",{hei:!0,kWidth:2});$("\u7EC6\u9ED1\u4F53",{hei:!0,kWidth:1});$("\u4E2D\u9ED1\u4F53",{hei:!0,kWidth:3});$("\u7C97\u9ED1\u4F53",{hei:!0,kWidth:5});$("\u7279\u9ED1\u4F53",{hei:!0,kWidth:7});var it=class{constructor(){this.hash={}}set(t,n){this.hash[t]=n}search(t){return this.hash[t]?this.hash[t]:""}push(t,n){this.set(t,n)}};var Et=class{constructor(){this.array=[]}clear(){this.array=[]}push(t){let n=200,r=0,o=200,i=0;if(!(t.length<3)){t.floor();for(let{x:s,y:a}of t.array)if(s<n&&(n=s),s>r&&(r=s),a<o&&(o=a),a>i&&(i=a),isNaN(s)||isNaN(a))return;n!==r&&o!==i&&this.array.push(t)}}generateSVG(t){let n=`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" baseProfile="full" viewBox="0 0 200 200" width="200" height="200">
`;if(t)for(let{array:r}of this.array){let o="L";n+='<path d="';for(let i=0;i<r.length;i++)i===0?n+="M ":r[i].off?(n+="Q ",o="Q"):(o==="Q"&&!r[i-1].off||o==="L"&&i===1)&&(n+="L "),n+=`${r[i].x},${r[i].y} `;n+=`Z" fill="black" />
`}else n+=`<g fill="black">
`,n+=this.array.map(({array:r})=>`<polygon points="${r.map(({x:o,y:i})=>`${o},${i} `).join("")}" />
`).join(""),n+=`</g>
`;return n+=`</svg>
`,n}generateEPS(){let t="";t+=`%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 -208 1024 816
%%Pages: 0
%%Title: Kanji glyph
%%Creator: GlyphWiki powered by KAGE system
%%CreationDate: ${new Date().toString()}
%%EndComments
%%EndProlog
`;for(let{array:n}of this.array){for(let r=0;r<n.length;r++)t+=`${n[r].x*5} ${1e3-n[r].y*5-200} `,r===0?t+=`newpath
moveto
`:t+=`lineto
`;t+=`closepath
fill
`}return t+=`%%EOF
`,t}},J=Et;Symbol.iterator,(()=>{typeof Symbol!="undefined"&&Symbol.iterator&&(Et.prototype[Symbol.iterator]=function(){return this.array[Symbol.iterator]()})})();var H=Math.hypot?Math.hypot.bind(Math):(e,t)=>Math.sqrt(e*e+t*t);function _([e,t],n=1){if(e===0&&t===0)return[1/e===1/0?n:-n,0];let r=n/H(e,t);return[e*r,t*r]}function at(e,t,n,r){let o=1-r;return o*o*e+2*(o*r)*t+r*r*n}function Wt(e,t,n,r){return 2*(r*(e-2*t+n)-e+t)}function vt(e,t,n,r,o){let i=1-o;return i*i*i*e+3*(i*i*o)*t+3*(i*o*o)*n+o*o*o*r}function Bt(e,t,n,r,o){return 3*(o*(o*(-e+3*t-3*n+r)+2*(e-2*t+n))-e+t)}function Ft(e,t,n,r=1e-5){for(;t+r<n;){let o=t+(n-t)/3,i=n-(n-t)/3,s=e(o),a=e(i);s<a?n=i:t=o}return t+(n-t)/2}function F(e,t=1e8){return Math.round(e*t)/t}function ht(e,t,n,r){return e*r-n*t}function st(e,t,n,r,o,i,s,a){let c=ht(n-e,r-t,s-o,a-i);if(isNaN(c))return!0;if(c===0)return!1;let h=ht(n-e,r-t,o-e,i-t),d=ht(n-e,r-t,s-e,a-t),l=ht(s-o,a-i,e-o,t-i),m=ht(s-o,a-i,n-o,r-i);return F(h*d,1e5)<=0&&F(l*m,1e5)<=0}function ue(e,t,n,r,o,i,s,a){return!!(st(e,t,n,r,o,i,s,i)||st(e,t,n,r,s,i,s,a)||st(e,t,n,r,o,a,s,a)||st(e,t,n,r,o,i,o,a))}function q(e,t,n,r,o){let i,s,a,c;return n<t+100?(i=r,a=r,s=t+100,c=e+100):(i=t+100,a=e+100,s=o,c=o),Math.floor((n-i)/(s-i)*(c-a)+a)}var At=class{constructor(t){[this.a1_100,this.a2_100,this.a3_100,this.x1,this.y1,this.x2,this.y2,this.x3,this.y3,this.x4,this.y4]=t,this.a1_opt=Math.floor(this.a1_100/100),this.a1_100%=100,this.a2_opt=Math.floor(this.a2_100/100),this.a2_100%=100,this.a2_opt_1=this.a2_opt%10,this.a2_opt_2=Math.floor(this.a2_opt/10)%10,this.a2_opt_3=Math.floor(this.a2_opt/100),this.a3_opt=Math.floor(this.a3_100/100),this.a3_100%=100,this.a3_opt_1=this.a3_opt%10,this.a3_opt_2=Math.floor(this.a3_opt/10)}getControlSegments(){let t=[];switch(this.a1_opt===0?this.a1_100:1){case 0:case 8:case 9:break;case 6:case 7:t.unshift([this.x3,this.y3,this.x4,this.y4]);case 2:case 12:case 3:case 4:t.unshift([this.x2,this.y2,this.x3,this.y3]);default:t.unshift([this.x1,this.y1,this.x2,this.y2])}return t}isCross(t,n,r,o){return this.getControlSegments().some(([i,s,a,c])=>st(i,s,a,c,t,n,r,o))}isCrossBox(t,n,r,o){return this.getControlSegments().some(([i,s,a,c])=>ue(i,s,a,c,t,n,r,o))}stretch(t,n,r,o,i,s,a,c){this.x1=q(t,n,this.x1,i,s),this.y1=q(r,o,this.y1,a,c),this.x2=q(t,n,this.x2,i,s),this.y2=q(r,o,this.y2,a,c),this.a1_100===99&&this.a1_opt===0||(this.x3=q(t,n,this.x3,i,s),this.y3=q(r,o,this.y3,a,c),this.x4=q(t,n,this.x4,i,s),this.y4=q(r,o,this.y4,a,c))}getBox(){let t=1/0,n=1/0,r=-1/0,o=-1/0;switch(this.a1_opt===0?this.a1_100:6){default:t=Math.min(t,this.x4),r=Math.max(r,this.x4),n=Math.min(n,this.y4),o=Math.max(o,this.y4);case 2:case 3:case 4:t=Math.min(t,this.x3),r=Math.max(r,this.x3),n=Math.min(n,this.y3),o=Math.max(o,this.y3);case 1:case 99:t=Math.min(t,this.x1,this.x2),r=Math.max(r,this.x1,this.x2),n=Math.min(n,this.y1,this.y2),o=Math.max(o,this.y1,this.y2);case 0:}return{minX:t,maxX:r,minY:n,maxY:o}}};function It(e,t,n,r,o,i,s){let c=Math.floor(s.length*.5),h=c/s.length,d=e+(n-e)*h,l=t+(r-t)*h,m=n+(o-n)*h,p=r+(i-r)*h,f=d+(m-d)*h,k=l+(p-l)*h;return{index:c,off:[[e,t,d,l,f,k],[f,k,m,p,o,i]]}}function Rt(e,t,n){let[r,o]=e[0],[i,s]=e[e.length-1],a=8,c=Ft(d=>e.reduce((l,m,p)=>{let f=p/(e.length-1),k=at(r,d,i,f);return l+R(m[0]-k,2)},0),t-a,t+a),h=Ft(d=>e.reduce((l,m,p)=>{let f=p/(e.length-1),k=at(o,d,s,f);return l+R(m[1]-k,2)},0),n-a,n+a);return[r,o,c,h,i,s]}function lt(e,t,n,r,o,i,s,a,c,h,d=_){let l={left:[],right:[]},m=n===o&&r===i,p,f,k,x;m?(p=u=>at(e,n,s,u),f=u=>at(t,r,a,u),k=u=>Wt(e,n,s,u),x=u=>Wt(t,r,a,u)):(p=u=>vt(e,n,o,s,u),f=u=>vt(t,r,i,a,u),k=u=>Bt(e,n,o,s,u),x=u=>Bt(t,r,i,a,u));for(let u=0;u<=1e3;u+=c){let b=u/1e3,y=p(b),w=f(b),M=k(b),A=x(b),g=h(b),[S,j]=d([-A,M],g);l.left.push([y-S,w-j]),l.right.push([y+S,w+j])}return l}var Pt=class{constructor(t){this._precision=10;if(this._array=[],t)if(typeof t=="number")for(let n=0;n<t;n++)this.push(0,0,!1);else for(let{x:n,y:r,off:o}of t)this.push(n,r,o)}get array(){return this._array.map((t,n)=>this.get(n))}get length(){return this._array.length}push(t,n,r=!1){this._array.push(this.createInternalPoint(t,n,r))}pushPoint(t){this.push(t.x,t.y,t.off)}set(t,n,r,o=!1){this._array[t]=this.createInternalPoint(n,r,o)}setPoint(t,n){this.set(t,n.x,n.y,n.off)}get(t){let{x:n,y:r,off:o}=this._array[t];return this._precision===0?{x:n,y:r,off:o}:{x:n/this._precision,y:r/this._precision,off:o}}reverse(){this._array.reverse()}concat(t){if(this._precision!==t._precision)throw new TypeError("Cannot concat polygon's with different precisions");this._array=this._array.concat(t._array)}shift(){this._array.shift()}unshift(t,n,r=!1){this._array.unshift(this.createInternalPoint(t,n,r))}clone(){return new Pt(this.array)}createInternalPoint(t,n,r=!1){return this._precision===0?{x:t,y:n,off:r}:{x:t*this._precision,y:n*this._precision,off:r}}translate(t,n){this._precision!==0&&(t*=this._precision,n*=this._precision);for(let r of this._array)r.x+=t,r.y+=n;return this}reflectX(){for(let t of this._array)t.x*=-1;return this}reflectY(){for(let t of this._array)t.y*=-1;return this}rotate90(){for(let t of this._array){let{x:n,y:r}=t;t.x=-r,t.y=n}return this}rotate180(){for(let t of this._array)t.x*=-1,t.y*=-1;return this}rotate270(){for(let t of this._array){let{x:n,y:r}=t;t.x=r,t.y=-n}return this}floor(){if(this._precision===0)return this;for(let t of this._array){let{x:n,y:r}=t;t.x=Math.floor(n),t.y=Math.floor(r)}return this}},B=Pt;Symbol.iterator,(()=>{typeof Symbol!="undefined"&&Symbol.iterator&&(Pt.prototype[Symbol.iterator]=function(){let t=0;return{next:()=>t<this._array.length?{done:!1,value:this.get(t++)}:{done:!0,value:void 0}}})})();var E=class{constructor(t,n){this.cos_theta=1;this.sin_theta=0;this.x=t,this.y=n}setMatrix2(t,n){return this.cos_theta=t,this.sin_theta=n,this}setLeft(t,n){let[r,o]=_([t-this.x,n-this.y]);return this.setMatrix2(-r,-o),this}setRight(t,n){let[r,o]=_([t-this.x,n-this.y]);return this.setMatrix2(r,o),this}setUp(t,n){let[r,o]=_([t-this.x,n-this.y]);return this.setMatrix2(-o,r),this}setDown(t,n){let[r,o]=_([t-this.x,n-this.y]);return this.setMatrix2(o,-r),this}move(t,n){return{x:this.x,y:this.y}=this.getPoint(t,n),this}getPoint(t,n,r){return{x:this.x+this.cos_theta*t+-this.sin_theta*n,y:this.y+this.sin_theta*t+this.cos_theta*n,off:r}}getPolygon(t){return new B(t.map(({x:n,y:r,off:o})=>this.getPoint(n,r,o)))}};function ce(e,t,n,r,o,i,s,a,c,h,d,l,m,p,f,k){let x=d,u=l,b=e.kMinWidthT-m/2,y;switch(x%100){case 0:case 7:case 27:y=-1*e.kMinWidthY*.5;break;case 1:case 2:case 6:case 22:case 32:y=0;break;case 12:y=e.kMinWidthY;break;default:return}if(y!==0){let[g,S]=n===o&&r===i?[0,y]:_([n-o,r-i],y);n+=g,r+=S}let w=0;if((x===22||x===27)&&u===7&&b>6){let g=H(o-n,i-r)+H(s-o,a-i)+H(c-s,h-a);g<100&&(w=(b-6)*((100-g)/100),n+=w)}let M;switch(u%100){case 0:case 1:case 7:case 9:case 15:case 14:case 17:case 5:M=0;break;case 8:M=-1*b*.5;break;default:M=y;break}if(M!==0){let[g,S]=s===c&&a===h?[0,-M]:_([c-s,h-a],M);c+=g,h+=S}let A=o===s&&i===a;if(A&&e.kUseCurve){let S=x===7&&u===0?X=>R(X,.5)*1.1:x===7?X=>R(X,.5):u===7?X=>R(1-X,.5):f>0?X=>1-f/2/(b-k/2)+f/2/(b-k)*X:()=>1,{left:j,right:P}=lt(n,r,o,i,o,i,c,h,10,X=>{let tt=S(X);return tt<.15&&(tt=.15),b*tt},([X,tt],$t)=>tt===0?[-$t,0]:_([X,tt],$t)),{off:[T,Y],index:C}=It(n,r,o,i,c,h,j),W=j.slice(0,C+1),L=j.slice(C),{off:[I,N],index:z}=It(n,r,o,i,c,h,P),v=Rt(W,T[2],T[3]),G=Rt(L,Y[2],Y[3]),dt=new B([{x:v[0],y:v[1]},{x:v[2],y:v[3],off:!0},{x:v[4],y:v[5]},{x:G[2],y:G[3],off:!0},{x:G[4],y:G[5]}]),kt=new B([{x:P[0][0],y:P[0][1]},{x:I[2]-(v[2]-T[2]),y:I[3]-(v[3]-T[3]),off:!0},{x:P[z][0],y:P[z][1]},{x:N[2]-(G[2]-Y[2]),y:N[3]-(G[3]-Y[3]),off:!0},{x:P[P.length-1][0],y:P[P.length-1][1]}]);kt.reverse(),dt.concat(kt),t.push(dt)}else{let g=.5;H(c-n,h-r)<50&&(g+=.4*(1-H(c-n,h-r)/50));let S=(x===7||x===27)&&u===0?C=>R(C,g)*e.kL2RDfatten:x===7||x===27?A?C=>R(C,g):C=>R(R(C,g),.7):u===7?C=>R(1-C,g):A&&(f>0||k>0)?C=>(e.kMinWidthT-f/2-(k-f)/2*C)/e.kMinWidthT:()=>1,{left:j,right:P}=lt(n,r,o,i,s,a,c,h,e.kRate,C=>{let W=S(C);return W<.15&&(W=.15),b*W},([C,W],L)=>F(C)===0&&F(W)===0?[-L,0]:_([C,W],L)),T=new B,Y=new B;for(let[C,W]of j)T.push(C,W);for(let[C,W]of P)Y.push(C,W);if(x===132||x===22&&(A?r>h:n>o)){T.floor(),Y.floor();for(let C=0,W=Y.length;C+1<W;C++){let L=Y.get(C),I=Y.get(C+1);if(L.y<=r&&r<=I.y){let N=I.x+(L.x-I.x)*(r-I.y)/(L.y-I.y),z=r,v=T.get(0),G=T.get(1),dt=x===132?v.x+(G.x-v.x)*(r-v.y)/(G.y-v.y):v.x+(G.x-v.x+1)*(r-v.y)/(G.y-v.y),kt=x===132?r:r+1;for(let X=0;X<C;X++)Y.shift();Y.set(0,N,z),T.unshift(dt,kt);break}}}Y.reverse(),T.concat(Y),t.push(T)}switch(x){case 12:{let g=new E(n,r);n!==o&&g.setDown(o,i);let S=g.getPolygon([{x:-b,y:0},{x:+b,y:0},{x:-b,y:-b}]);t.push(S);break}case 0:{if(r<=h){let g=new E(n,r);n!==o&&g.setDown(o,i);let S=Math.atan2(Math.abs(r-i),Math.abs(n-o))/Math.PI*2-.4;S>0?S*=2:S*=16;let j=S<0?-1:1,P=g.getPolygon([{x:-b,y:1},{x:+b,y:0},{x:-j*b,y:-e.kMinWidthY*Math.abs(S)}]);t.push(P);let T=S<0?-S*e.kMinWidthY:0,Y=g.getPolygon(n===o&&r===i?[{x:b,y:-T},{x:b*1.5,y:e.kMinWidthY-T},{x:b-2,y:e.kMinWidthY*2+1}]:[{x:b,y:-T},{x:b*1.5,y:e.kMinWidthY-T*1.2},{x:b-2,y:e.kMinWidthY*2-T*.8+1}]);t.push(Y)}else{let g=new E(n,r);n===o?g.setMatrix2(0,1):g.setRight(o,i);let S=g.getPolygon([{x:0,y:+b},{x:0,y:-b},{x:-e.kMinWidthY,y:-b}]);t.push(S);let j=g.getPolygon([{x:0,y:+b},{x:+e.kMinWidthY,y:+b*1.5},{x:+e.kMinWidthY*3,y:+b*.5}]);t.push(j)}break}case 22:case 27:{let g=new E(n-w,r).getPolygon([{x:-b,y:-e.kMinWidthY},{x:0,y:-e.kMinWidthY-e.kWidth},{x:+b+e.kWidth,y:+e.kMinWidthY},{x:+b,y:+b-1}].concat(x===27?[{x:0,y:+b+2},{x:0,y:0}]:[{x:-b,y:+b+4}]));t.push(g);break}}switch(u){case 1:case 8:case 15:{let g=e.kMinWidthT-k/2,S=new E(c,h);s===c?S.setMatrix2(0,1):a!==h&&S.setLeft(s,a);let j=S.getPolygon(e.kUseCurve?[{x:0,y:-g},{x:+g*.9,y:-g*.9,off:!0},{x:+g,y:0},{x:+g*.9,y:+g*.9,off:!0},{x:0,y:+g}]:[{x:0,y:-g},{x:+g*.7,y:-g*.7},{x:+g,y:0},{x:+g*.7,y:+g*.7},{x:0,y:+g}]);if(s===c&&j.reverse(),t.push(j),u===15){let P=new E(c,h);r>=h&&P.setMatrix2(-1,0);let T=P.getPolygon([{x:0,y:-b+1},{x:2,y:-b-e.kWidth*5},{x:0,y:-b-e.kWidth*5},{x:-b,y:-b+1}]);t.push(T)}break}case 0:if(!(x===7||x===27))break;case 9:{let g=Math.atan2(Math.abs(h-a),Math.abs(c-s))/Math.PI*2-.6;g>0?g*=8:g*=3;let S=g<0?-1:1,j=new E(c,h);a===h?j.setMatrix2(1,0):s===c?j.setMatrix2(0,h>a?-1:1):j.setLeft(s,a);let P=j.getPolygon([{x:0,y:+b*e.kL2RDfatten},{x:0,y:-b*e.kL2RDfatten},{x:Math.abs(g)*b*e.kL2RDfatten,y:S*b*e.kL2RDfatten}]);t.push(P);break}case 14:{let g=b>6?6/b:1,S=e.kWidth*4*Math.min(1-p/10,R(b/e.kMinWidthT,3))*g,j=new E(c,h).getPolygon([{x:0,y:0},{x:0,y:-b},{x:-S,y:-b},{x:-S,y:-b*.5}]);t.push(j);break}}}function Ut(e,t,n,r,o,i,s,a,c,h,d,l,m,p,f,k){ce(e,t,n,r,o,i,s,a,c,h,d,l,m,p,f,k)}function V(e,t,n,r,o,i,s,a,c,h,d,l,m,p){ce(e,t,n,r,o,i,o,i,s,a,c,h,d,l,m,p)}function Q(e,t,n,r,o,i,s,a,c,h,d){let l=n,m=r,p=o,f=i,k=s,x=a,u=e.kMinWidthT-c/2;if(l===p||m!==f&&(l>p||Math.abs(f-m)>=Math.abs(p-l)||k===6||x===6)){let[b,y]=l===p?[0,1]:_([p-l,f-m]),w=new E(l,m),M=new E(p,f);w.setMatrix2(y,-b),M.setMatrix2(y,-b);let A=new B(4);switch(k){case 0:A.setPoint(0,w.getPoint(u,e.kMinWidthY/2)),A.setPoint(3,w.getPoint(-u,-e.kMinWidthY/2));break;case 1:case 6:A.setPoint(0,w.getPoint(u,0)),A.setPoint(3,w.getPoint(-u,0));break;case 12:A.setPoint(0,w.getPoint(u,-e.kMinWidthY)),A.setPoint(3,w.getPoint(-u,-e.kMinWidthY-u));break;case 22:if(l===p)A.set(0,l+u,m),A.set(3,l-u,m);else{let g=l>p?-1:1;A.set(0,l+(u+g)/y,m+1),A.set(3,l-u/y,m)}break;case 32:l===p?(A.set(0,l+u,m-e.kMinWidthY),A.set(3,l-u,m-e.kMinWidthY)):(A.set(0,l+u/y,m),A.set(3,l-u/y,m));break}switch(x){case 0:k===6?(A.setPoint(1,M.getPoint(u,0)),A.setPoint(2,M.getPoint(-u,0))):(A.setPoint(1,M.getPoint(u,-u/2)),A.setPoint(2,M.getPoint(-u,u/2)));break;case 5:if(l===p)break;case 1:A.setPoint(1,M.getPoint(u,0)),A.setPoint(2,M.getPoint(-u,0));break;case 13:A.setPoint(1,M.getPoint(u,e.kAdjustKakatoL[d])),A.setPoint(2,M.getPoint(-u,e.kAdjustKakatoL[d]+u));break;case 23:A.setPoint(1,M.getPoint(u,e.kAdjustKakatoR[d])),A.setPoint(2,M.getPoint(-u,e.kAdjustKakatoR[d]+u));break;case 24:case 32:l===p?(A.set(1,p+u,f+e.kMinWidthY),A.set(2,p-u,f+e.kMinWidthY)):(A.set(1,p+u/y,f),A.set(2,p-u/y,f));break}switch(t.push(A),x){case 24:{let g=new E(p,f).getPolygon([{x:0,y:+e.kMinWidthY},l===p?{x:+u,y:-e.kMinWidthY*3}:{x:+u*.5,y:-e.kMinWidthY*4},{x:+u*2,y:-e.kMinWidthY},{x:+u*2,y:+e.kMinWidthY}]);t.push(g);break}case 13:if(d===4)if(l===p){let g=new E(p,f).getPolygon([{x:-u,y:-e.kMinWidthY*3},{x:-u*2,y:0},{x:-e.kMinWidthY,y:+e.kMinWidthY*5},{x:+u,y:+e.kMinWidthY}]);t.push(g)}else{let g=l>p&&m!==f?Math.floor((l-p)/(f-m)*3):0,S=new E(p+g,f).getPolygon([{x:0,y:-e.kMinWidthY*5},{x:-u*2,y:0},{x:-e.kMinWidthY,y:+e.kMinWidthY*5},{x:+u,y:+e.kMinWidthY},{x:0,y:0}]);t.push(S)}break}switch(k){case 22:case 27:{let g=new E(l,m).getPolygon([{x:-u,y:-e.kMinWidthY},{x:0,y:-e.kMinWidthY-e.kWidth},{x:+u+e.kWidth,y:+e.kMinWidthY}].concat(l===p?[{x:+u,y:+u},{x:-u,y:0}]:k===27?[{x:+u,y:+u-1},{x:0,y:+u+2},{x:0,y:0}]:[{x:+u,y:+u-1},{x:-u,y:+u+4}]));t.push(g);break}case 0:{let g=w.getPolygon([{x:u,y:e.kMinWidthY*.5},{x:u+u*.5,y:e.kMinWidthY*.5+e.kMinWidthY},{x:u-2,y:e.kMinWidthY*.5+e.kMinWidthY*2+1}]);l!==p&&g.set(2,l+(u-2)*y+(e.kMinWidthY*.5+e.kMinWidthY*2)*b,m+(u+1)*-b+(e.kMinWidthY*.5+e.kMinWidthY*2)*y),t.push(g);break}}if(l===p&&x===1||k===6&&(x===0||l!==p&&x===5)){let g=new B;if(e.kUseCurve)g.pushPoint(M.getPoint(u,0)),g.push(p-b*u*.9+-y*-u*.9,f+y*u*.9+b*-u*.9,!0),g.pushPoint(M.getPoint(0,u)),g.pushPoint(M.getPoint(-u*.9,u*.9,!0)),g.pushPoint(M.getPoint(-u,0));else{let S=l===p&&(k===6&&x===0||x===1)?.6:.8;g.pushPoint(M.getPoint(u,0)),g.pushPoint(M.getPoint(u*.6,u*S)),g.pushPoint(M.getPoint(0,u)),g.pushPoint(M.getPoint(-u*.6,u*S)),g.pushPoint(M.getPoint(-u,0))}if(l===p&&(k===6&&x===0||x===1)&&g.reverse(),t.push(g),l!==p&&k===6&&x===5){let S=e.kWidth*5,j=l<p?1:-1,P=M.getPolygon([{x:j*(u-1),y:0},{x:j*(u+S),y:2},{x:j*(u+S),y:0},{x:u-1,y:-u}]);t.push(P)}}}else if(m===f&&k===6){let b=new E(l,m),y=new E(p,f),w=new B([b.getPoint(0,-u),y.getPoint(0,-u),y.getPoint(0,+u),b.getPoint(0,+u)]);switch(t.push(w),x){case 1:case 0:case 5:{let M=new E(p,f);l>p&&M.setMatrix2(-1,0);let A=.6,g=M.getPolygon(e.kUseCurve?[{x:0,y:-u},{x:+u*.9,y:-u*.9,off:!0},{x:+u,y:0},{x:+u*.9,y:+u*.9,off:!0},{x:0,y:+u}]:[{x:0,y:-u},{x:+u*A,y:-u*.6},{x:+u,y:0},{x:+u*A,y:+u*.6},{x:0,y:+u}]);if(l>=p&&g.reverse(),t.push(g),x===5){let S=e.kWidth*(4*(1-c/e.kAdjustMageStep)+1),j=l<p?1:-1,P=M.getPolygon([{x:0,y:j*-u},{x:2,y:j*(-u-S)},{x:0,y:j*(-u-S)},{x:-u,y:j*-u}]);t.push(P)}break}}}else{let[b,y]=m===f?[1,0]:_([p-l,f-m]),w=new E(l,m),M=new E(p,f);w.setMatrix2(b,y),M.setMatrix2(b,y);let A=new B([w.getPoint(0,-e.kMinWidthY),M.getPoint(0,-e.kMinWidthY),M.getPoint(0,e.kMinWidthY),w.getPoint(0,e.kMinWidthY)]);switch(t.push(A),x){case 0:{let g=(e.kMinWidthU/e.kMinWidthY-1)/4+1,S=M.getPolygon([{x:0,y:-e.kMinWidthY},{x:-e.kAdjustUrokoX[h]*g,y:0}]);S.push(p-(b-y)*e.kAdjustUrokoX[h]*g/2,f-(y+b)*e.kAdjustUrokoY[h]*g),t.push(S);break}}}}function mt(e,t,n,r,o){return e.array.filter(i=>i.array.every(({x:s,y:a})=>t<=s&&s<=r&&n<=a&&a<=o))}function Se(e,t,{stroke:{a1_100:n,a2_100:r,a2_opt:o,a2_opt_1:i,a2_opt_2:s,a2_opt_3:a,a3_100:c,a3_opt:h,a3_opt_1:d,a3_opt_2:l,x1:m,y1:p,x2:f,y2:k,x3:x,y3:u,x4:b,y4:y},kirikuchiAdjustment:w,tateAdjustment:M,haneAdjustment:A,urokoAdjustment:g,kakatoAdjustment:S,mageAdjustment:j}){switch(n){case 0:if(r===98&&o===0){let P=m+f,T=0;for(let Y of mt(t,m,p,f,k))Y.reflectX().translate(P,T).floor()}else if(r===97&&o===0){let T=p+k;for(let Y of mt(t,m,p,f,k))Y.reflectY().translate(0,T).floor()}else if(r===99&&o===0){if(c===1&&h===0){let P=m+k,T=p-m;for(let Y of mt(t,m,p,f,k))Y.rotate90().translate(P,T).floor()}else if(c===2&&h===0){let P=m+f,T=p+k;for(let Y of mt(t,m,p,f,k))Y.rotate180().translate(P,T).floor()}else if(c===3&&h===0){let P=m-p,T=k+m;for(let Y of mt(t,m,p,f,k))Y.rotate270().translate(P,T).floor()}}break;case 1:{if(c===4){let[P,T]=m===f&&p===k?[0,e.kMage]:_([m-f,p-k],e.kMage),Y=f+P,C=k+T;Q(e,t,m,p,Y,C,r+i*100,1,M,0,0),V(e,t,Y,C,f,k,f-e.kMage*((e.kAdjustTateStep+4-M)/(e.kAdjustTateStep+4)),k,1,14,M%10,A,Math.floor(M/10),l)}else Q(e,t,m,p,f,k,r+i*100,c,M,g,S);break}case 2:{if(c===4){let[P,T]=f===x?[0,-e.kMage]:k===u?[-e.kMage,0]:_([f-x,k-u],e.kMage),Y=x+P,C=u+T;V(e,t,m,p,f,k,Y,C,r+w*100,0,s,0,a,0),V(e,t,Y,C,x,u,x-e.kMage,u,2,14,s,A,0,l)}else V(e,t,m,p,f,k,x,u,r+w*100,c===5&&h===0?15:c,s,d,a,l);break}case 3:{let[P,T]=m===f&&p===k?[0,e.kMage]:_([m-f,p-k],e.kMage),Y=f+P,C=k+T,[W,L]=f===x&&k===u?[0,-e.kMage]:_([x-f,u-k],e.kMage),I=f+W,N=k+L;if(Q(e,t,m,p,Y,C,r+i*100,1,M,0,0),V(e,t,Y,C,f,k,I,N,1,1,0,0,M,j),!(c===5&&d===0&&!(f<x&&x-I>0||f>x&&I-x>0))){let z=c===5&&d===0?0:d+j*10;Q(e,t,I,N,x,u,6,c,j,z,z)}break}case 12:{V(e,t,m,p,f,k,x,u,r+i*100,1,s,0,a,0),Q(e,t,x,u,b,y,6,c,0,h,h);break}case 4:{let P=H(x-f,u-k)/120*6;P>6&&(P=6);let[T,Y]=m===f&&p===k?[0,e.kMage*P]:_([m-f,p-k],e.kMage*P),C=f+T,W=k+Y,[L,I]=f===x&&k===u?[0,-e.kMage*P]:_([x-f,u-k],e.kMage*P),N=f+L,z=k+I;Q(e,t,m,p,C,W,r+i*100,1,s+a*10,0,0),V(e,t,C,W,f,k,N,z,1,1,0,0,0,0),c===5&&h===0&&x-N<=0||Q(e,t,N,z,x,u,6,c,0,h,h);break}case 6:{if(c===4){let[P,T]=x===b?[0,-e.kMage]:u===y?[-e.kMage,0]:_([x-b,u-y],e.kMage),Y=b+P,C=y+T;Ut(e,t,m,p,f,k,x,u,Y,C,r+i*100,1,s,0,a,0),V(e,t,Y,C,b,y,b-e.kMage,y,1,14,0,A,0,l)}else Ut(e,t,m,p,f,k,x,u,b,y,r+i*100,c===5&&h===0?15:c,s,d,a,l);break}case 7:{Q(e,t,m,p,f,k,r+i*100,1,M,0,0),V(e,t,f,k,x,u,b,y,1,c,M%10,d,Math.floor(M/10),l);break}case 9:break;default:break}}var Dt=class{constructor(){this.shotai=0;this.kRate=100;this.kMinWidthY=2;this.kMinWidthU=2;this.kMinWidthT=6;this.kWidth=5;this.kKakato=3;this.kL2RDfatten=1.1;this.kMage=10;this.kUseCurve=!1;this.kAdjustKakatoL=[14,9,5,2,0];this.kAdjustKakatoR=[8,6,4,2];this.kAdjustKakatoRangeX=20;this.kAdjustKakatoRangeY=[1,19,24,30];this.kAdjustKakatoStep=3;this.kAdjustUrokoX=[24,20,16,12];this.kAdjustUrokoY=[12,11,9,8];this.kAdjustUrokoLength=[22,36,50];this.kAdjustUrokoLengthStep=3;this.kAdjustUrokoLine=[22,26,30];this.kAdjustUroko2Step=3;this.kAdjustUroko2Length=40;this.kAdjustTateStep=4;this.kAdjustMageStep=5;this.setSize()}setSize(t){t===1?(this.kMinWidthY=1.2,this.kMinWidthT=3.6,this.kWidth=3,this.kKakato=1.8,this.kL2RDfatten=1.1,this.kMage=6,this.kUseCurve=!1,this.kAdjustKakatoL=[8,5,3,1,0],this.kAdjustKakatoR=[4,3,2,1],this.kAdjustKakatoRangeX=12,this.kAdjustKakatoRangeY=[1,11,14,18],this.kAdjustKakatoStep=3,this.kAdjustUrokoX=[14,12,9,7],this.kAdjustUrokoY=[7,6,5,4],this.kAdjustUrokoLength=[13,21,30],this.kAdjustUrokoLengthStep=3,this.kAdjustUrokoLine=[13,15,18]):(this.kMinWidthY=2,this.kMinWidthU=2,this.kMinWidthT=6,this.kWidth=5,this.kKakato=3,this.kL2RDfatten=1.1,this.kMage=10,this.kUseCurve=!1,this.kAdjustKakatoL=[14,9,5,2,0],this.kAdjustKakatoR=[8,6,4,2],this.kAdjustKakatoRangeX=20,this.kAdjustKakatoRangeY=[1,19,24,30],this.kAdjustKakatoStep=3,this.kAdjustUrokoX=[24,20,16,12],this.kAdjustUrokoY=[12,11,9,8],this.kAdjustUrokoLength=[22,36,50],this.kAdjustUrokoLengthStep=3,this.kAdjustUrokoLine=[22,26,30],this.kAdjustUroko2Step=3,this.kAdjustUroko2Length=40,this.kAdjustTateStep=4,this.kAdjustMageStep=5)}getDrawers(t){return this.adjustStrokes(t).map(n=>r=>{Se(this,r,n)})}adjustStrokes(t){let n=t.map(r=>{let{a2_opt_1:o,a2_opt_2:i,a2_opt_3:s,a3_opt:a,a3_opt_1:c,a3_opt_2:h}=r;return{stroke:r,kirikuchiAdjustment:o,tateAdjustment:i+s*10,haneAdjustment:c,urokoAdjustment:a,kakatoAdjustment:a,mageAdjustment:h}});return this.adjustHane(n),this.adjustMage(n),this.adjustTate(n),this.adjustKakato(n),this.adjustUroko(n),this.adjustUroko2(n),this.adjustKirikuchi(n),n}adjustHane(t){let n=[];for(let{stroke:r}of t)r.a1_100===1&&r.a1_opt===0&&r.x1===r.x2&&n.push({stroke:r,x:r.x1,y1:r.y1,y2:r.y2});for(let r of t){let{stroke:o}=r;if((o.a1_100===1||o.a1_100===2||o.a1_100===6)&&o.a1_opt===0&&o.a3_100===4&&o.a3_opt===0){let i,s;o.a1_100===1?(i=o.x2,s=o.y2):o.a1_100===2?(i=o.x3,s=o.y3):(i=o.x4,s=o.y4);let a=1/0;i+18<100&&(a=i+18);for(let{stroke:c,x:h,y1:d,y2:l}of n)o!==c&&i-h<100&&h<i&&d<=s&&l>=s&&(a=Math.min(a,i-h));a!==1/0&&(r.haneAdjustment+=7-Math.floor(a/15))}}return t}adjustMage(t){let n=[];for(let r of t){let{stroke:o}=r;o.a1_100===1&&o.a1_opt===0&&o.y1===o.y2?n.push({stroke:o,adjStroke:r,isTarget:!1,y:o.y2,x1:o.x1,x2:o.x2}):o.a1_100===3&&o.a1_opt===0&&o.y2===o.y3&&n.push({stroke:o,adjStroke:r,isTarget:!0,y:o.y2,x1:o.x2,x2:o.x3})}for(let{adjStroke:r,stroke:o,isTarget:i,y:s,x1:a,x2:c}of n)if(i)for(let{stroke:h,y:d,x1:l,x2:m}of n)o!==h&&!(a+1>m||c-1<l)&&F(Math.abs(s-d))<this.kMinWidthT*this.kAdjustMageStep&&(r.mageAdjustment+=this.kAdjustMageStep-Math.floor(Math.abs(s-d)/this.kMinWidthT),r.mageAdjustment>this.kAdjustMageStep&&(r.mageAdjustment=this.kAdjustMageStep));return t}adjustTate(t){let n=[];for(let r of t){let{stroke:o}=r;(o.a1_100===1||o.a1_100===3||o.a1_100===7)&&o.a1_opt===0&&o.x1===o.x2&&n.push({stroke:o,adjStroke:r,x:o.x1,y1:o.y1,y2:o.y2})}for(let{adjStroke:r,stroke:o,x:i,y1:s,y2:a}of n)for(let{stroke:c,x:h,y1:d,y2:l}of n)o!==c&&!(s+1>l||a-1<d)&&F(Math.abs(i-h))<this.kMinWidthT*this.kAdjustTateStep&&(r.tateAdjustment+=this.kAdjustTateStep-Math.floor(Math.abs(i-h)/this.kMinWidthT),(r.tateAdjustment>this.kAdjustTateStep||r.tateAdjustment===this.kAdjustTateStep&&(o.a2_opt_1!==0||o.a2_100!==0))&&(r.tateAdjustment=this.kAdjustTateStep));return t}adjustKakato(t){for(let n of t){let{stroke:r}=n;if(r.a1_100===1&&r.a1_opt===0&&(r.a3_100===13||r.a3_100===23)&&r.a3_opt===0){for(let o=0;o<this.kAdjustKakatoStep;o++)if(t.some(({stroke:i})=>r!==i&&i.isCrossBox(r.x2-this.kAdjustKakatoRangeX/2,r.y2+this.kAdjustKakatoRangeY[o],r.x2+this.kAdjustKakatoRangeX/2,r.y2+this.kAdjustKakatoRangeY[o+1]))||F(r.y2+this.kAdjustKakatoRangeY[o+1])>200||F(r.y2-r.y1)<this.kAdjustKakatoRangeY[o+1]){n.kakatoAdjustment=3-o;break}}}return t}adjustUroko(t){for(let n of t){let{stroke:r}=n;if(r.a1_100===1&&r.a1_opt===0&&r.a3_100===0&&r.a3_opt===0)for(let o=0;o<this.kAdjustUrokoLengthStep;o++){let[i,s]=r.y1===r.y2?[1,0]:r.x2-r.x1<0?_([r.x1-r.x2,r.y1-r.y2]):_([r.x2-r.x1,r.y2-r.y1]),a=r.x2-this.kAdjustUrokoLine[o]*i-.5*s,c=r.y2-this.kAdjustUrokoLine[o]*s-.5*i,h=r.y1===r.y2?r.x2-r.x1:H(r.y2-r.y1,r.x2-r.x1);if(F(h)<this.kAdjustUrokoLength[o]||t.some(({stroke:d})=>r!==d&&d.isCross(a,c,r.x2,r.y2))){n.urokoAdjustment=this.kAdjustUrokoLengthStep-o;break}}}return t}adjustUroko2(t){let n=[];for(let r of t){let{stroke:o}=r;o.a1_100===1&&o.a1_opt===0&&o.y1===o.y2?n.push({stroke:o,adjStroke:r,isTarget:o.a3_100===0&&o.a3_opt===0&&r.urokoAdjustment===0,y:o.y1,x1:o.x1,x2:o.x2}):o.a1_100===3&&o.a1_opt===0&&o.y2===o.y3&&n.push({stroke:o,adjStroke:r,isTarget:!1,y:o.y2,x1:o.x2,x2:o.x3})}for(let{adjStroke:r,stroke:o,isTarget:i,y:s,x1:a,x2:c}of n)if(i){let h=0;for(let{stroke:d,y:l,x1:m,x2:p}of n)o!==d&&!(a+1>p||c-1<m)&&F(Math.abs(s-l))<this.kAdjustUroko2Length&&(h+=R(this.kAdjustUroko2Length-Math.abs(s-l),1.1));r.urokoAdjustment=Math.min(Math.floor(h/this.kAdjustUroko2Length),this.kAdjustUroko2Step)}return t}adjustKirikuchi(t){let n=[];for(let{stroke:r}of t)r.a1_100===1&&r.a1_opt===0&&r.y1===r.y2&&n.push({y:r.y1,x1:r.x1,x2:r.x2});for(let r of t){let{stroke:o}=r;o.a1_100===2&&o.a1_opt===0&&o.a2_100===32&&o.a2_opt===0&&o.x1>o.x2&&o.y1<o.y2&&n.some(({y:i,x1:s,x2:a})=>s<o.x1&&a>o.x1&&i===o.y1)&&(r.kirikuchiAdjustment=1)}return t}},ft=Dt;function ae(e,t,n,r,o,i,s,a,c,h,d,l){let m=d,p=l,f=0;switch(m%10){case 2:f=e.kWidth;break;case 3:f=e.kWidth*e.kKakato;break}if(f!==0){let[w,M]=n===o&&r===i?[0,f]:_([n-o,r-i],f);n+=w,r+=M}let k=0;switch(p%10){case 2:k=e.kWidth;break;case 3:k=e.kWidth*e.kKakato;break}if(k!==0){let[w,M]=s===c&&a===h?[0,-k]:_([c-s,h-a],k);c+=w,h+=M}let{left:x,right:u}=lt(n,r,o,i,s,a,c,h,e.kRate,()=>e.kWidth,([w,M],A)=>F(w)===0&&F(M)===0?[-A,0]:_([w,M],A)),b=new B,y=new B;for(let[w,M]of x)b.push(w,M);for(let[w,M]of u)y.push(w,M);y.reverse(),b.concat(y),t.push(b)}function Xt(e,t,n,r,o,i,s,a,c,h,d,l){ae(e,t,n,r,o,i,s,a,c,h,d,l)}function K(e,t,n,r,o,i,s,a,c,h){ae(e,t,n,r,o,i,o,i,s,a,c,h)}function Z(e,t,n,r,o,i,s,a){let c,h,d,l,m,p;n===o&&r>i||n>o?(c=o,h=i,d=n,l=r,m=a,p=s):(c=n,h=r,d=o,l=i,m=s,p=a);let f=new E(c,h),k=new E(d,l);switch((c!==d||h!==l)&&(f.setDown(d,l),k.setUp(c,h)),m%10){case 2:f.move(0,-e.kWidth);break;case 3:f.move(0,-e.kWidth*e.kKakato);break}switch(p%10){case 2:k.move(0,e.kWidth);break;case 3:k.move(0,e.kWidth*e.kKakato);break}let x=new B([f.getPoint(e.kWidth,0),k.getPoint(e.kWidth,0),k.getPoint(-e.kWidth,0),f.getPoint(-e.kWidth,0)]);n===o&&x.reverse(),t.push(x)}function Ae(e,t,{stroke:{a1_100:n,a2_100:r,a3_100:o,a3_opt:i,a3_opt_1:s,a3_opt_2:a,x1:c,y1:h,x2:d,y2:l,x3:m,y3:p,x4:f,y4:k},haneAdjustment:x,mageAdjustment:u}){switch(n){case 0:break;case 1:{if(o===4&&x===0&&a===0){let[b,y]=c===d&&h===l?[0,e.kMage]:_([c-d,h-l],e.kMage),w=d+b,M=l+y;Z(e,t,c,h,w,M,r,1),K(e,t,w,M,d,l,d-e.kMage*2,l-e.kMage*.5,1,0)}else Z(e,t,c,h,d,l,r,o);break}case 2:case 12:{if(o===4&&x===0&&a===0){let[b,y]=d===m?[0,-e.kMage]:l===p?[-e.kMage,0]:_([d-m,l-p],e.kMage),w=m+b,M=p+y;K(e,t,c,h,d,l,w,M,r,1),K(e,t,w,M,m,p,m-e.kMage*2,p-e.kMage*.5,1,0)}else if(o===5&&i===0){let b=m+e.kMage,y=p,w=b+e.kMage*.5,M=p-e.kMage*2;K(e,t,c,h,d,l,m,p,r,1),K(e,t,m,p,b,y,w,M,1,0)}else K(e,t,c,h,d,l,m,p,r,o);break}case 3:{let[b,y]=c===d&&h===l?[0,e.kMage]:_([c-d,h-l],e.kMage),w=d+b,M=l+y,[A,g]=d===m&&l===p?[0,-e.kMage]:_([m-d,p-l],e.kMage),S=d+A,j=l+g;if(Z(e,t,c,h,w,M,r,1),K(e,t,w,M,d,l,S,j,1,1),o===5&&s===0&&u===0){let P=m-e.kMage,T=p,Y=m+e.kMage*.5,C=p-e.kMage*2;Z(e,t,S,j,P,T,1,1),K(e,t,P,T,m,p,Y,C,1,0)}else Z(e,t,S,j,m,p,1,o);break}case 6:{if(o===5&&i===0){let b=f-e.kMage,y=k,w=f+e.kMage*.5,M=k-e.kMage*2;Xt(e,t,c,h,d,l,m,p,b,y,r,1),K(e,t,b,y,f,k,w,M,1,0)}else Xt(e,t,c,h,d,l,m,p,f,k,r,o);break}case 7:{Z(e,t,c,h,d,l,r,1),K(e,t,d,l,m,p,f,k,1,o);break}case 9:break;default:break}}var Lt=class extends ft{constructor(){super(...arguments);this.shotai=1}getDrawers(n){return this.adjustStrokes(n).map(r=>o=>{Ae(this,o,r)})}},Nt=Lt;function Gt(e){switch(e){case 0:return new ft;default:return new Nt}}var O=class{constructor(t){this.kMincho=0;this.kGothic=1;this.kFont=Gt(0);this.stretch=q;this.kFont.setSize(t),this.kBuhin=new it}get kShotai(){return this.kFont.shotai}set kShotai(t){this.kFont=Gt(t)}get kUseCurve(){return this.kFont.kUseCurve}set kUseCurve(t){this.kFont.kUseCurve=t}makeGlyph(t,n){let r=this.kBuhin.search(n);this.makeGlyph2(t,r)}makeGlyph2(t,n){if(n!==""){let r=this.getEachStrokes(n),o=this.kFont.getDrawers(r);for(let i of o)i(t)}}makeGlyph3(t){let n=[];if(t!==""){let r=this.getEachStrokes(t),o=this.kFont.getDrawers(r);for(let i of o){let s=new J;i(s),n.push(s)}}return n}makeGlyphSeparated(t){let n=t.map(s=>this.getEachStrokes(s)),r=this.kFont.getDrawers(n.reduce((s,a)=>s.concat(a),[])),o=new J,i=0;return n.map(({length:s})=>{let a=o.array.length;for(let h of r.slice(i,i+s))h(o);i+=s;let c=new J;return c.array=o.array.slice(a),c})}getEachStrokes(t){let n=[],r=t.split("$");for(let o of r){let i=o.split(":");if(Math.floor(+i[0])!==99)n.push(new At([Math.floor(+i[0]),Math.floor(+i[1]),Math.floor(+i[2]),Math.floor(+i[3]),Math.floor(+i[4]),Math.floor(+i[5]),Math.floor(+i[6]),Math.floor(+i[7]),Math.floor(+i[8]),Math.floor(+i[9]),Math.floor(+i[10])]));else{let s=this.kBuhin.search(i[7]);s!==""&&(n=n.concat(this.getEachStrokesOfBuhin(s,Math.floor(+i[3]),Math.floor(+i[4]),Math.floor(+i[5]),Math.floor(+i[6]),Math.floor(+i[1]),Math.floor(+i[2]),Math.floor(+i[9]),Math.floor(+i[10]))))}}return n}getEachStrokesOfBuhin(t,n,r,o,i,s,a,c,h){let d=this.getEachStrokes(t),l=this.getBox(d);(s!==0||a!==0)&&(s>100?s-=200:(c=0,h=0));for(let m of d)(s!==0||a!==0)&&m.stretch(s,c,a,h,l.minX,l.maxX,l.minY,l.maxY),m.x1=n+m.x1*(o-n)/200,m.y1=r+m.y1*(i-r)/200,m.x2=n+m.x2*(o-n)/200,m.y2=r+m.y2*(i-r)/200,m.x3=n+m.x3*(o-n)/200,m.y3=r+m.y3*(i-r)/200,m.x4=n+m.x4*(o-n)/200,m.y4=r+m.y4*(i-r)/200;return d}getBox(t){let n=200,r=200,o=0,i=0;for(let s of t){let{minX:a,maxX:c,minY:h,maxY:d}=s.getBox();n=Math.min(n,a),o=Math.max(o,c),r=Math.min(r,h),i=Math.max(i,d)}return{minX:n,maxX:o,minY:r,maxY:i}}};O.Buhin=it,O.Polygons=J;var Pe=(e,t)=>{if(e==t||!t)return"";let n=St(U(e),!0),r=St(U(t)).map(a=>UnifiedComps_UTF32[a]||a),o=qt(n,r),i=r.filter(a=>o.indexOf(a)==-1),s=n.filter(a=>o.indexOf(a)==-1);return i.length===1&&s.length===1?t+String.fromCodePoint(i)+String.fromCodePoint(s):""},Kt=(e,t=!1)=>{let n=[],r=et(e),o=0,i=0,s="";for(;o<r.length;){let a=e;if(i&&i--,~re(r[o]).indexOf(r[o+1]))s+=r[o]+r[o+1],i++,o++;else if(i)s+=r[o];else if(s)n.push(s+r[o]),s="";else{let h=r[o];t&&!U(h)&&(h=Pe(h)||h),n.push(h)}o++}return s&&n.push(s),n},he=e=>rt(e)>1&&Kt(e).length==1;var D=new O;D.kUseCurve=!0;var Ot=[],le=(e,t=64)=>e.replace(/(width|height)=\"\d+\"/g,(n,r,o)=>r+"="+t),me=(e,t)=>e.replace(/<svg /,"<svg "+t+" "),pe=(e,t)=>e.replace(/fill="black"/g,'fill="'+t+'"'),fe=(e,t)=>{t=t||D;let n=se(e.fontface||"");if(n){t.kShotai=n.hei?1:0;for(let r in n)t.kFont[r]=n[r]}else t.kShotai=e.hei?1:0,t.kFont.kWidth=e.width||5},de=(e,t)=>{let n=_t(e),r="";for(let o=0;o<n.length;o++){let[i,s,a,c]=n[o],h=a-i,d=c-s,l="hsl("+(o+1)*60+" ,50%,30%)";r+=`<rect x=${i} y=${s} width=${h} height=${d} 
		 style="fill:none;stroke: ${l} ; stroke-width:${o+1}" ></rect>`}return appendToSVG(r,t)},we=(e,t={})=>{if(!e)return"";let n={},r=t.size||64,o=t.alt||!1,i=t.color||"black",s=t.frame||!1,a,c=new O.Polygons;e.codePointAt(0)<8192?a=e:a="u"+e.codePointAt(0).toString(16);let h=U(a);if(!h)return e;ot(h,n);for(let l in n)D.kBuhin.push(l,n[l]);D.kBuhin.push(a,h),Ot.push(...Object.keys(n)),fe(t,D),D.makeGlyph(c,a);let d=c.generateSVG(!0);return d=t.frame?de(h,d):d,d=me(d,'style="padding-top:0.2em" gid='+a+" title="+e),i!=="black"&&i&&(d=pe(d,i)),le(d,r)},Ce=(e,t={})=>{let n=bt(e);if(!he(e))return drawGlyphs(e);let r=0,o=new O.Polygons,i=t.size||64,s=[];for(;r<n.length-2;){let h={},d=U(n[r]);D.kBuhin.push(ct(n[r]),d),ot(d,h);let l,m,p;l=ct(n[r+1]||""),m=ct(n[r+2]||"");for(let f in h)if(f.slice(0,l.length)==l){let k=U(m+f.slice(l.length));k||(k=U(m)),D.kBuhin.push(f,k);let x={};ot(k,x);for(let u in x)D.kBuhin.push(u,x[u])}else D.kBuhin.push(f,h[f]);Ot.push(...Object.keys(h)),r+=2}let a=U(n[0]);D.kBuhin.push(e,a),fe(t,D),D.makeGlyph(o,e);let c=o.generateSVG(!0);return s.forEach(h=>c=appendToSVG(h,c)),c=t.frame?de(a,c):c,c=me(c,'style="padding-top:0.2em" title='+e),t.color!=="black"&&t.color&&(c=pe(c,t.color)),c=le(c,i),c},wt=(e,t={})=>{D=new O,D.kUseCurve=!0,Ot=[];let n=Kt(e,!0),r=[];for(let o=0;o<n.length;o++){let i=n[o];r.push(rt(i)==1?we(i,t):Ce(i,t))}return r};var Te=(e,t)=>{let n=Jt(e);return~t.indexOf(n)},ke=/\07([^\07]+)\07/g,be=(e,t={})=>{let n=t.pair||"\uFE3B\uFE3C",r=(t.cjk||"CDEFG").toUpperCase().split("").map(c=>"Ext"+c),o="",i=0,s=[],a=c=>{let h=s.indexOf(c);return h==-1?(s.push(c),s.length-1):h};if(e=e.replace(/([\ud800-\udfff]{2})/g,function(c,h){if(Te(h,r)){let d=a(h);return String.fromCharCode(7)+d.toString()+String.fromCharCode(7)}else return h}),n&&n.length==2){let[c,h]=et(n),d=new RegExp(c+"([^"+h+"]+)"+h,"g");e=e.replace(d,(l,m)=>{let p=a(m);return String.fromCharCode(7)+p.toString()+String.fromCharCode(7)})}return[e,s]},Ye=(e,t={})=>{if(!zt)return;let{color:n,fontSize:r}=window.getComputedStyle(e),o=parseInt(r)*1.1,[i,s]=be(e.innerHTML,t);e.innerHTML=i.replace(ke,(a,c)=>wt(s[parseInt(c)],{color:n,size:o}))},zn=async(e,t={})=>{let{color:n,fontSize:r}=window.getComputedStyle(e),[o,i]=be(e.innerHTML,t),s=await chrome.runtime.sendMessage({data:i});html.innerHTML=o.replace(ke,(a,c)=>s[parseInt(c)])},je=(e,t="")=>{if(!e)return;if(!zt)return e.innerText;t||(t=e.innerText);let{color:n,fontSize:r}=window.getComputedStyle(e),o=parseInt(r);return e.innerHTML=wt(t,{color:n,size:o}).join(""),e.innerText},_e=()=>new Promise(e=>{let t=setInterval(()=>{ne()&&(clearInterval(t),e())},100)}),zt=!0,Ee=e=>zt=e,We={addFontData:ut,ready:_e,drawPinx:wt,loadFont:oe,inject:Ye,render:je,onoff:Ee};typeof window<"u"&&!window.Hzpx&&(window.Hzpx=We);})();
